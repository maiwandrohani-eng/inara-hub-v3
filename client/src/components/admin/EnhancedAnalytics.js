import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
import { useQuery } from 'react-query';
import { useState } from 'react';
import api from '../../api/client';
export default function EnhancedAnalytics() {
    const [selectedTab, setSelectedTab] = useState('overview');
    const [dateRange, setDateRange] = useState('30d');
    const { data: overviewData, isLoading: overviewLoading } = useQuery(['analytics-overview', dateRange], async () => {
        const res = await api.get(`/analytics/overview?range=${dateRange}`);
        return res.data;
    });
    const { data: userData, isLoading: userLoading } = useQuery(['analytics-users', dateRange], async () => {
        const res = await api.get(`/analytics/users?range=${dateRange}`);
        return res.data;
    });
    const { data: contentData, isLoading: contentLoading } = useQuery(['analytics-content', dateRange], async () => {
        const res = await api.get(`/analytics/content?range=${dateRange}`);
        return res.data;
    });
    const { data: engagementData, isLoading: engagementLoading } = useQuery(['analytics-engagement', dateRange], async () => {
        const res = await api.get(`/analytics/engagement?range=${dateRange}`);
        return res.data;
    });
    return (_jsxs("div", { className: "space-y-6", children: [_jsxs("div", { className: "flex justify-between items-center", children: [_jsx("h2", { className: "text-2xl font-bold text-white", children: "Enhanced Analytics" }), _jsxs("select", { value: dateRange, onChange: (e) => setDateRange(e.target.value), className: "px-4 py-2 bg-gray-700 border border-gray-600 text-white rounded-lg", children: [_jsx("option", { value: "7d", children: "Last 7 days" }), _jsx("option", { value: "30d", children: "Last 30 days" }), _jsx("option", { value: "90d", children: "Last 90 days" }), _jsx("option", { value: "all", children: "All time" })] })] }), _jsx("div", { className: "flex space-x-2 border-b border-gray-700", children: ['overview', 'users', 'content', 'engagement'].map((tab) => (_jsx("button", { onClick: () => setSelectedTab(tab), className: `px-4 py-2 text-sm font-medium border-b-2 transition-colors ${selectedTab === tab
                        ? 'border-primary-500 text-primary-500'
                        : 'border-transparent text-gray-400 hover:text-gray-200'}`, children: tab.charAt(0).toUpperCase() + tab.slice(1) }, tab))) }), selectedTab === 'overview' && (_jsx("div", { className: "space-y-6", children: overviewLoading ? (_jsx("div", { className: "text-center py-12 text-gray-400", children: "Loading analytics..." })) : (_jsxs(_Fragment, { children: [_jsxs("div", { className: "grid grid-cols-1 md:grid-cols-4 gap-6", children: [_jsxs("div", { className: "bg-gray-800 rounded-lg shadow border border-gray-700 p-6", children: [_jsx("p", { className: "text-sm text-gray-400", children: "Total Users" }), _jsx("p", { className: "text-3xl font-bold text-white mt-2", children: overviewData?.metrics?.totalUsers || 0 }), _jsxs("p", { className: "text-xs text-gray-500 mt-1", children: [overviewData?.metrics?.activeUsers || 0, " active"] })] }), _jsxs("div", { className: "bg-gray-800 rounded-lg shadow border border-gray-700 p-6", children: [_jsx("p", { className: "text-sm text-gray-400", children: "Training Completions" }), _jsx("p", { className: "text-3xl font-bold text-white mt-2", children: overviewData?.metrics?.trainingCompletions || 0 }), _jsxs("p", { className: "text-xs text-gray-500 mt-1", children: [overviewData?.metrics?.trainingCompletionRate || 0, "% rate"] })] }), _jsxs("div", { className: "bg-gray-800 rounded-lg shadow border border-gray-700 p-6", children: [_jsx("p", { className: "text-sm text-gray-400", children: "Policy Certifications" }), _jsx("p", { className: "text-3xl font-bold text-white mt-2", children: overviewData?.metrics?.policyCertifications || 0 }), _jsxs("p", { className: "text-xs text-gray-500 mt-1", children: [overviewData?.metrics?.policyCertificationRate || 0, "% rate"] })] }), _jsxs("div", { className: "bg-gray-800 rounded-lg shadow border border-gray-700 p-6", children: [_jsx("p", { className: "text-sm text-gray-400", children: "Platform Engagement" }), _jsxs("p", { className: "text-3xl font-bold text-white mt-2", children: [overviewData?.metrics?.engagementScore || 0, "%"] }), _jsx("p", { className: "text-xs text-gray-500 mt-1", children: "Average score" })] })] }), _jsxs("div", { className: "bg-gray-800 rounded-lg shadow border border-gray-700 p-6", children: [_jsx("h3", { className: "text-lg font-semibold text-white mb-4", children: "Activity Over Time" }), _jsx("div", { className: "h-64 flex items-center justify-center text-gray-400", children: "Chart visualization would go here" })] })] })) })), selectedTab === 'users' && (_jsx("div", { className: "space-y-6", children: userLoading ? (_jsx("div", { className: "text-center py-12 text-gray-400", children: "Loading user analytics..." })) : (_jsxs(_Fragment, { children: [_jsxs("div", { className: "bg-gray-800 rounded-lg shadow border border-gray-700 p-6", children: [_jsx("h3", { className: "text-lg font-semibold text-white mb-4", children: "User Growth" }), _jsxs("div", { className: "grid grid-cols-2 md:grid-cols-4 gap-4", children: [_jsxs("div", { children: [_jsx("p", { className: "text-sm text-gray-400", children: "New Users" }), _jsx("p", { className: "text-2xl font-bold text-white", children: userData?.growth?.newUsers || 0 })] }), _jsxs("div", { children: [_jsx("p", { className: "text-sm text-gray-400", children: "Active Users" }), _jsx("p", { className: "text-2xl font-bold text-white", children: userData?.growth?.activeUsers || 0 })] }), _jsxs("div", { children: [_jsx("p", { className: "text-sm text-gray-400", children: "Retention Rate" }), _jsxs("p", { className: "text-2xl font-bold text-white", children: [userData?.growth?.retentionRate || 0, "%"] })] }), _jsxs("div", { children: [_jsx("p", { className: "text-sm text-gray-400", children: "Avg. Session" }), _jsxs("p", { className: "text-2xl font-bold text-white", children: [userData?.growth?.avgSessionTime || 0, "m"] })] })] })] }), _jsxs("div", { className: "bg-gray-800 rounded-lg shadow border border-gray-700 p-6", children: [_jsx("h3", { className: "text-lg font-semibold text-white mb-4", children: "Top Performers" }), _jsx("div", { className: "space-y-2", children: userData?.topPerformers?.map((user, idx) => (_jsxs("div", { className: "flex justify-between items-center bg-gray-700 p-3 rounded", children: [_jsxs("span", { className: "text-gray-200", children: [user.firstName, " ", user.lastName] }), _jsxs("span", { className: "text-primary-500 font-medium", children: ["Score: ", user.score || 0] })] }, user.id || idx))) })] })] })) })), selectedTab === 'content' && (_jsx("div", { className: "space-y-6", children: contentLoading ? (_jsx("div", { className: "text-center py-12 text-gray-400", children: "Loading content analytics..." })) : (_jsx(_Fragment, { children: _jsxs("div", { className: "grid grid-cols-1 md:grid-cols-3 gap-6", children: [_jsxs("div", { className: "bg-gray-800 rounded-lg shadow border border-gray-700 p-6", children: [_jsx("p", { className: "text-sm text-gray-400", children: "Most Viewed" }), _jsx("p", { className: "text-2xl font-bold text-white mt-2", children: contentData?.mostViewed?.title || 'N/A' }), _jsxs("p", { className: "text-xs text-gray-500 mt-1", children: [contentData?.mostViewed?.views || 0, " views"] })] }), _jsxs("div", { className: "bg-gray-800 rounded-lg shadow border border-gray-700 p-6", children: [_jsx("p", { className: "text-sm text-gray-400", children: "Most Downloaded" }), _jsx("p", { className: "text-2xl font-bold text-white mt-2", children: contentData?.mostDownloaded?.title || 'N/A' }), _jsxs("p", { className: "text-xs text-gray-500 mt-1", children: [contentData?.mostDownloaded?.downloads || 0, " downloads"] })] }), _jsxs("div", { className: "bg-gray-800 rounded-lg shadow border border-gray-700 p-6", children: [_jsx("p", { className: "text-sm text-gray-400", children: "Most Commented" }), _jsx("p", { className: "text-2xl font-bold text-white mt-2", children: contentData?.mostCommented?.title || 'N/A' }), _jsxs("p", { className: "text-xs text-gray-500 mt-1", children: [contentData?.mostCommented?.comments || 0, " comments"] })] })] }) })) })), selectedTab === 'engagement' && (_jsx("div", { className: "space-y-6", children: engagementLoading ? (_jsx("div", { className: "text-center py-12 text-gray-400", children: "Loading engagement analytics..." })) : (_jsx(_Fragment, { children: _jsxs("div", { className: "bg-gray-800 rounded-lg shadow border border-gray-700 p-6", children: [_jsx("h3", { className: "text-lg font-semibold text-white mb-4", children: "Engagement Metrics" }), _jsxs("div", { className: "grid grid-cols-2 md:grid-cols-4 gap-4", children: [_jsxs("div", { children: [_jsx("p", { className: "text-sm text-gray-400", children: "Daily Active" }), _jsx("p", { className: "text-2xl font-bold text-white", children: engagementData?.dailyActive || 0 })] }), _jsxs("div", { children: [_jsx("p", { className: "text-sm text-gray-400", children: "Weekly Active" }), _jsx("p", { className: "text-2xl font-bold text-white", children: engagementData?.weeklyActive || 0 })] }), _jsxs("div", { children: [_jsx("p", { className: "text-sm text-gray-400", children: "Avg. Time" }), _jsxs("p", { className: "text-2xl font-bold text-white", children: [engagementData?.avgTime || 0, "m"] })] }), _jsxs("div", { children: [_jsx("p", { className: "text-sm text-gray-400", children: "Bounce Rate" }), _jsxs("p", { className: "text-2xl font-bold text-white", children: [engagementData?.bounceRate || 0, "%"] })] })] })] }) })) }))] }));
}
