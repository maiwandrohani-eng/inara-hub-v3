generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                           String                        @id @default(uuid())
  email                        String                        @unique
  passwordHash                 String
  firstName                    String
  lastName                     String
  phone                        String?
  whatsapp                     String?
  role                         UserRole
  department                   Department?
  country                      String?
  city                         String?
  address                      String?
  clearance                    String?
  isActive                     Boolean                       @default(true)
  lastLogin                    DateTime?
  createdAt                    DateTime                      @default(now())
  updatedAt                    DateTime                      @updatedAt
  activityLogs                 ActivityLog[]
  bookmarks                    Bookmark[]
  certificates                 Certificate[]
  comments                     Comment[]
  libraryAccess                LibraryAccess[]
  marketSubmissions            MarketSubmission[]
  NewsConfirmation             NewsConfirmation[]
  notifications                Notification[]
  orientationCompletion        OrientationCompletion?
  orientationStepConfirmations OrientationStepConfirmation[]
  policyCertifications         PolicyCertification[]
  searchHistory                SearchHistory[]
  Suggestion                   Suggestion[]
  SuggestionVote               SuggestionVote[]
  surveySubmissions            SurveySubmission[]
  templateDownloads            TemplateDownload[]
  trainingCompletions          TrainingCompletion[]
  achievements                 UserAchievement[]
  userPreferences              UserPreferences?
  workSystemAccess             WorkSystemAccess[]

  @@index([email])
  @@index([role, department, country])
}

model SystemConfig {
  id          String   @id @default(uuid())
  type        String
  key         String
  value       String
  description String?
  order       Int      @default(0)
  isActive    Boolean  @default(true)
  metadata    Json?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@unique([type, key])
  @@index([type, isActive])
}

model WorkSystem {
  id          String                 @id @default(uuid())
  name        String                 @unique
  url         String
  description String?
  icon        String?
  isActive    Boolean                @default(true)
  order       Int                    @default(0)
  createdAt   DateTime               @default(now())
  updatedAt   DateTime               @updatedAt
  userAccess  WorkSystemAccess[]
  accessRules WorkSystemAccessRule[]

  @@index([name])
}

model WorkSystemAccessRule {
  id                  String       @id @default(uuid())
  workSystemId        String
  requiredTrainingIds String[]
  requiredPolicyIds   String[]
  allowedRoles        UserRole[]
  allowedDepartments  Department[]
  allowedCountries    String[]
  isActive            Boolean      @default(true)
  createdAt           DateTime     @default(now())
  updatedAt           DateTime     @updatedAt
  workSystem          WorkSystem   @relation(fields: [workSystemId], references: [id], onDelete: Cascade)

  @@index([workSystemId])
}

model WorkSystemAccess {
  id           String     @id @default(uuid())
  userId       String
  workSystemId String
  grantedAt    DateTime   @default(now())
  expiresAt    DateTime?
  lastAccessed DateTime?
  accessCount  Int        @default(0)
  user         User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  workSystem   WorkSystem @relation(fields: [workSystemId], references: [id], onDelete: Cascade)

  @@unique([userId, workSystemId])
  @@index([userId])
  @@index([workSystemId])
}

model Training {
  id                  String               @id @default(uuid())
  title               String
  description         String?
  content             String
  duration            Int
  objectives          String[]
  sections            Json
  quiz                Json?
  passingScore        Int                  @default(70)
  certificateRules    Json?
  courseType          CourseType           @default(PROFESSIONAL_COURSE)
  courseDuration      CourseDuration       @default(SHORT_TERM)
  isMandatory         Boolean              @default(false)
  isOptional          Boolean              @default(true)
  trackId             String?
  trackOrder          Int?
  assignedTo          AccessLevel          @default(GLOBAL)
  assignedRoles       UserRole[]
  assignedDepartments Department[]
  assignedCountries   String[]
  validityPeriod      Int?
  requiresRenewal     Boolean              @default(false)
  expiryDate          DateTime?
  category            String?
  subcategory         String?
  tags                String[]
  isActive            Boolean              @default(true)
  createdAt           DateTime             @default(now())
  updatedAt           DateTime             @updatedAt
  sourceFileUrl       String?
  autoGenerated       Boolean              @default(false)
  bookmarks           Bookmark[]
  certificates        Certificate[]
  comments            Comment[]
  resources           CourseResource[]
  lessons             Lesson[]
  track               Track?               @relation(fields: [trackId], references: [id])
  completions         TrainingCompletion[]
  versions            TrainingVersion[]
  trainingPaths       TrainingPath[]       @relation("TrainingToTrainingPath")

  @@index([isMandatory, isActive])
  @@index([category])
  @@index([courseType])
  @@index([trackId])
}

model CourseResource {
  id           String   @id @default(uuid())
  trainingId   String
  title        String
  description  String?
  fileUrl      String
  fileName     String
  fileSize     Int?
  fileType     String
  resourceType String   @default("module")
  order        Int      @default(0)
  isRequired   Boolean  @default(false)
  isActive     Boolean  @default(true)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  training     Training @relation(fields: [trainingId], references: [id], onDelete: Cascade)

  @@index([trainingId])
  @@index([trainingId, order])
}

model TrainingPath {
  id          String     @id @default(uuid())
  name        String
  description String?
  isActive    Boolean    @default(true)
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  trainings   Training[] @relation("TrainingToTrainingPath")
}

model Track {
  id          String     @id @default(uuid())
  name        String
  description String?
  type        CourseType
  isActive    Boolean    @default(true)
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  courses     Training[]

  @@index([type])
}

model Lesson {
  id         String   @id @default(uuid())
  trainingId String
  title      String
  order      Int      @default(0)
  content    String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  training   Training @relation(fields: [trainingId], references: [id], onDelete: Cascade)
  slides     Slide[]

  @@unique([trainingId, order])
  @@index([trainingId])
}

model Slide {
  id        String     @id @default(uuid())
  lessonId  String
  title     String
  content   String
  order     Int        @default(0)
  slideType String     @default("content")
  mediaUrl  String?
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  microQuiz MicroQuiz?
  lesson    Lesson     @relation(fields: [lessonId], references: [id], onDelete: Cascade)

  @@unique([lessonId, order])
  @@index([lessonId])
}

model MicroQuiz {
  id           String   @id @default(uuid())
  slideId      String   @unique
  title        String
  questions    Json
  passingScore Int      @default(70)
  isRequired   Boolean  @default(true)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  slide        Slide    @relation(fields: [slideId], references: [id], onDelete: Cascade)
}

model Certificate {
  id                String    @id @default(uuid())
  trainingId        String
  userId            String
  certificateNumber String    @unique
  fullName          String
  courseTitle       String
  completionDate    DateTime
  expiryDate        DateTime?
  score             Int?
  passingScore      Int
  passed            Boolean
  certificateUrl    String
  signedBy          String?
  signatureDate     DateTime  @default(now())
  isRecertified     Boolean   @default(false)
  recertifiedFrom   String?
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt
  training          Training  @relation(fields: [trainingId], references: [id], onDelete: Cascade)
  user              User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, trainingId])
  @@index([userId])
  @@index([trainingId])
  @@index([certificateNumber])
  @@index([expiryDate])
}

model TrainingCompletion {
  id             String         @id @default(uuid())
  userId         String
  trainingId     String
  status         TrainingStatus @default(NOT_STARTED)
  progress       Int            @default(0)
  score          Int?
  completedAt    DateTime?
  expiresAt      DateTime?
  certificateUrl String?
  createdAt      DateTime       @default(now())
  updatedAt      DateTime       @updatedAt
  training       Training       @relation(fields: [trainingId], references: [id], onDelete: Cascade)
  user           User           @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, trainingId])
  @@index([userId])
  @@index([trainingId])
  @@index([status, expiresAt])
}

model Orientation {
  id          String                  @id @default(uuid())
  title       String
  content     String
  sections    Json
  pdfFiles    Json?
  isActive    Boolean                 @default(true)
  version     Int                     @default(1)
  updatedAt   DateTime                @updatedAt
  createdAt   DateTime                @default(now())
  completions OrientationCompletion[]
  steps       OrientationStep[]
}

model OrientationStep {
  id            String                        @id @default(uuid())
  orientationId String
  stepNumber    Int
  title         String
  description   String?
  content       String?
  pdfUrl        String?
  policyId      String?
  questions     Json?
  isRequired    Boolean                       @default(true)
  order         Int                           @default(0)
  createdAt     DateTime                      @default(now())
  updatedAt     DateTime                      @updatedAt
  orientation   Orientation                   @relation(fields: [orientationId], references: [id], onDelete: Cascade)
  confirmations OrientationStepConfirmation[]

  @@unique([orientationId, stepNumber])
  @@index([orientationId, order])
}

model OrientationStepConfirmation {
  id          String          @id @default(uuid())
  userId      String
  stepId      String
  confirmedAt DateTime        @default(now())
  notes       String?
  responses   Json?
  step        OrientationStep @relation(fields: [stepId], references: [id], onDelete: Cascade)
  user        User            @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, stepId])
  @@index([userId])
  @@index([stepId])
}

model OrientationCompletion {
  id             String      @id @default(uuid())
  userId         String      @unique
  orientationId  String
  completedAt    DateTime    @default(now())
  score          Int?
  checklistData  Json?
  certificateUrl String?
  orientation    Orientation @relation(fields: [orientationId], references: [id], onDelete: Cascade)
  user           User        @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
}

model Policy {
  id                  String                @id @default(uuid())
  title               String
  brief               String
  complete            String
  assessment          Json?
  version             Int                   @default(1)
  effectiveDate       DateTime
  owner               String?
  reviewCycle         Int?
  isMandatory         Boolean               @default(false)
  assignedTo          AccessLevel           @default(GLOBAL)
  assignedRoles       UserRole[]
  assignedDepartments Department[]
  assignedCountries   String[]
  category            String?
  subcategory         String?
  tags                String[]
  fileUrl             String?
  isActive            Boolean               @default(true)
  createdAt           DateTime              @default(now())
  updatedAt           DateTime              @updatedAt
  bookmarks           Bookmark[]
  comments            Comment[]
  certifications      PolicyCertification[]
  versions            PolicyVersion[]

  @@index([isMandatory, isActive])
  @@index([category])
}

model PolicyVersion {
  id            String   @id @default(uuid())
  policyId      String
  version       Int
  content       String
  effectiveDate DateTime
  archivedAt    DateTime @default(now())
  policy        Policy   @relation(fields: [policyId], references: [id], onDelete: Cascade)

  @@index([policyId])
}

model PolicyCertification {
  id              String       @id @default(uuid())
  userId          String
  policyId        String
  status          PolicyStatus @default(NOT_ACKNOWLEDGED)
  acknowledgedAt  DateTime?
  assessmentScore Int?
  expiresAt       DateTime?
  createdAt       DateTime     @default(now())
  updatedAt       DateTime     @updatedAt
  policy          Policy       @relation(fields: [policyId], references: [id], onDelete: Cascade)
  user            User         @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, policyId])
  @@index([userId])
  @@index([policyId])
  @@index([status, expiresAt])
}

model LibraryResource {
  id           String            @id @default(uuid())
  title        String
  description  String?
  content      String?
  fileUrl      String?
  resourceType String
  category     String?
  subcategory  String?
  tags         String[]
  author       String?
  publishDate  DateTime?
  language     String            @default("en")
  isActive     Boolean           @default(true)
  createdAt    DateTime          @default(now())
  updatedAt    DateTime          @updatedAt
  bookmarks    Bookmark[]
  comments     Comment[]
  versions     DocumentVersion[]
  accesses     LibraryAccess[]

  @@index([resourceType, category])
  @@index([tags])
}

model LibraryAccess {
  id         String          @id @default(uuid())
  userId     String
  resourceId String
  accessedAt DateTime        @default(now())
  duration   Int?
  resource   LibraryResource @relation(fields: [resourceId], references: [id], onDelete: Cascade)
  user       User            @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([resourceId])
  @@index([accessedAt])
}

model MarketSubmission {
  id                   String       @id @default(uuid())
  userId               String
  fullName             String?
  jobTitle             String?
  countryOffice        String?
  department           String?
  email                String?
  phone                String?
  whatsapp             String?
  title                String
  ideaType             String
  problemNeed          String
  proposedSolution     String
  beneficiaries        String[]
  estimatedImpact      String
  estimatedCost        String
  fundingPotential     String
  urgency              String
  leadershipInterest   String
  attachments          String[]
  declarationConfirmed Boolean      @default(false)
  status               MarketStatus @default(NEW)
  assignedReviewer     String?
  reviewScore          Int?
  bonusApproved        Boolean      @default(false)
  bonusAmount          Float?
  internalNotes        String?
  problemStatement     String?
  targetPopulation     String?
  objective            String?
  outcomes             String[]
  activities           String[]
  budgetRange          String?
  risks                String?
  mitigations          String?
  sustainability       String?
  implementationPlan   String?
  alignment            String?
  reviewerNotes        String?
  reviewerId           String?
  reviewedAt           DateTime?
  createdAt            DateTime     @default(now())
  updatedAt            DateTime     @updatedAt
  user                 User         @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([status])
  @@index([createdAt])
  @@index([ideaType])
}

model Template {
  id             String             @id @default(uuid())
  title          String
  description    String?
  fileUrl        String
  category       String?
  subcategory    String?
  owner          String?
  version        Int                @default(1)
  approvalStatus String             @default("approved")
  lastUpdated    DateTime           @default(now())
  tags           String[]
  isActive       Boolean            @default(true)
  createdAt      DateTime           @default(now())
  updatedAt      DateTime           @updatedAt
  bookmarks      Bookmark[]
  comments       Comment[]
  downloads      TemplateDownload[]
  versions       TemplateVersion[]

  @@index([category])
  @@index([approvalStatus])
}

model TemplateDownload {
  id           String   @id @default(uuid())
  userId       String
  templateId   String
  downloadedAt DateTime @default(now())
  template     Template @relation(fields: [templateId], references: [id], onDelete: Cascade)
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([templateId])
  @@index([downloadedAt])
}

model ActivityLog {
  id           String   @id @default(uuid())
  userId       String
  action       String
  resourceType String?
  resourceId   String?
  details      Json?
  ipAddress    String?
  userAgent    String?
  createdAt    DateTime @default(now())
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([action])
  @@index([createdAt])
  @@index([resourceType, resourceId])
}

model BotKnowledge {
  id         String   @id @default(uuid())
  question   String
  answer     String
  sourceType String
  sourceId   String?
  tags       String[]
  isActive   Boolean  @default(true)
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@index([tags])
  @@index([sourceType, sourceId])
}

model Notification {
  id           String    @id @default(uuid())
  userId       String
  type         String
  title        String
  message      String
  link         String?
  resourceType String?
  resourceId   String?
  isRead       Boolean   @default(false)
  readAt       DateTime?
  createdAt    DateTime  @default(now())
  user         User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId, isRead])
  @@index([createdAt])
}

model Bookmark {
  id                String           @id @default(uuid())
  userId            String
  resourceType      String
  resourceId        String
  folder            String?
  notes             String?
  createdAt         DateTime         @default(now())
  trainingId        String?
  policyId          String?
  libraryResourceId String?
  templateId        String?
  LibraryResource   LibraryResource? @relation(fields: [libraryResourceId], references: [id])
  Policy            Policy?          @relation(fields: [policyId], references: [id])
  Template          Template?        @relation(fields: [templateId], references: [id])
  Training          Training?        @relation(fields: [trainingId], references: [id])
  user              User             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, resourceType, resourceId])
  @@index([userId])
  @@index([resourceType, resourceId])
}

model Comment {
  id                String           @id @default(uuid())
  userId            String
  resourceType      String
  resourceId        String
  content           String
  parentId          String?
  isEdited          Boolean          @default(false)
  editedAt          DateTime?
  createdAt         DateTime         @default(now())
  updatedAt         DateTime         @updatedAt
  trainingId        String?
  policyId          String?
  libraryResourceId String?
  templateId        String?
  newsId            String?
  suggestionId      String?
  LibraryResource   LibraryResource? @relation(fields: [libraryResourceId], references: [id])
  News              News?            @relation(fields: [newsId], references: [id])
  parent            Comment?         @relation("CommentReplies", fields: [parentId], references: [id], onDelete: Cascade)
  replies           Comment[]        @relation("CommentReplies")
  Policy            Policy?          @relation(fields: [policyId], references: [id])
  Suggestion        Suggestion?      @relation(fields: [suggestionId], references: [id])
  Template          Template?        @relation(fields: [templateId], references: [id])
  Training          Training?        @relation(fields: [trainingId], references: [id])
  user              User             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([resourceType, resourceId])
  @@index([userId])
  @@index([parentId])
}

model UserAchievement {
  id              String   @id @default(uuid())
  userId          String
  achievementType String
  title           String
  description     String?
  icon            String?
  earnedAt        DateTime @default(now())
  user            User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([achievementType])
}

model SearchHistory {
  id          String   @id @default(uuid())
  userId      String
  query       String
  filters     Json?
  resultCount Int?
  createdAt   DateTime @default(now())
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([createdAt])
}

model UserPreferences {
  id              String   @id @default(uuid())
  userId          String   @unique
  theme           String   @default("dark")
  language        String   @default("en")
  timezone        String?
  emailDigest     Boolean  @default(true)
  emailFrequency  String   @default("daily")
  notifications   Json?
  shortcuts       Json?
  dashboardLayout Json?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  user            User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model CalendarEvent {
  id                  String       @id @default(uuid())
  title               String
  description         String?
  eventType           String
  startDate           DateTime
  endDate             DateTime?
  allDay              Boolean      @default(false)
  resourceType        String?
  resourceId          String?
  assignedTo          AccessLevel  @default(GLOBAL)
  assignedRoles       UserRole[]
  assignedDepartments Department[]
  assignedCountries   String[]
  userId              String?
  isRecurring         Boolean      @default(false)
  recurrenceRule      String?
  createdAt           DateTime     @default(now())
  updatedAt           DateTime     @updatedAt

  @@index([startDate])
  @@index([eventType])
  @@index([resourceType, resourceId])
}

model DocumentVersion {
  id                String           @id @default(uuid())
  resourceType      String
  resourceId        String
  version           Int
  content           String
  fileUrl           String?
  changeLog         String?
  createdBy         String?
  createdAt         DateTime         @default(now())
  libraryResourceId String?
  LibraryResource   LibraryResource? @relation(fields: [libraryResourceId], references: [id])

  @@index([resourceType, resourceId])
  @@index([version])
}

model TrainingVersion {
  id         String   @id @default(uuid())
  trainingId String
  version    Int
  content    String
  changeLog  String?
  archivedAt DateTime @default(now())
  training   Training @relation(fields: [trainingId], references: [id], onDelete: Cascade)

  @@index([trainingId])
}

model TemplateVersion {
  id         String   @id @default(uuid())
  templateId String
  version    Int
  fileUrl    String
  changeLog  String?
  archivedAt DateTime @default(now())
  template   Template @relation(fields: [templateId], references: [id], onDelete: Cascade)

  @@index([templateId])
}

model News {
  id            String             @id @default(uuid())
  title         String
  content       String
  summary       String?
  priority      String             @default("normal")
  isActive      Boolean            @default(true)
  publishedAt   DateTime           @default(now())
  expiresAt     DateTime?
  createdBy     String?
  createdAt     DateTime           @default(now())
  updatedAt     DateTime           @updatedAt
  comments      Comment[]
  confirmations NewsConfirmation[]

  @@index([isActive, publishedAt])
  @@index([priority])
}

model NewsConfirmation {
  id          String   @id @default(uuid())
  newsId      String
  userId      String
  confirmedAt DateTime @default(now())
  news        News     @relation(fields: [newsId], references: [id], onDelete: Cascade)
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([newsId, userId])
  @@index([newsId])
  @@index([userId])
}

model Suggestion {
  id          String           @id @default(uuid())
  userId      String
  title       String
  description String
  category    String?
  status      String           @default("submitted")
  priority    String?
  adminNotes  String?
  reviewedBy  String?
  reviewedAt  DateTime?
  isActive    Boolean          @default(true)
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt
  comments    Comment[]
  user        User             @relation(fields: [userId], references: [id], onDelete: Cascade)
  votes       SuggestionVote[]

  @@index([userId])
  @@index([status])
  @@index([category])
  @@index([createdAt])
}

model SuggestionVote {
  id           String     @id @default(uuid())
  suggestionId String
  userId       String
  voteType     String
  createdAt    DateTime   @default(now())
  suggestion   Suggestion @relation(fields: [suggestionId], references: [id], onDelete: Cascade)
  user         User       @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([suggestionId, userId])
  @@index([suggestionId])
  @@index([userId])
}

model Survey {
  id                  String             @id @default(uuid())
  title               String
  description         String?
  type                String
  questions           Json
  isAnonymous         Boolean            @default(false)
  hasTimeLimit        Boolean            @default(false)
  timeLimitMinutes    Int?
  passingScore        Int?
  maxAttempts         Int?
  isMandatory         Boolean            @default(false)
  assignedTo          AccessLevel        @default(GLOBAL)
  assignedRoles       UserRole[]
  assignedDepartments Department[]
  assignedCountries   String[]
  assignedUserIds     String[]
  startDate           DateTime?
  endDate             DateTime?
  dueDate             DateTime?
  category            String?
  tags                String[]
  isActive            Boolean            @default(true)
  createdBy           String?
  createdAt           DateTime           @default(now())
  updatedAt           DateTime           @updatedAt
  analytics           SurveyAnalytics?
  submissions         SurveySubmission[]

  @@index([type, isActive])
  @@index([createdBy])
  @@index([startDate, endDate])
}

model SurveySubmission {
  id               String    @id @default(uuid())
  surveyId         String
  userId           String
  responses        Json
  totalScore       Int?
  maxScore         Int?
  percentageScore  Float?
  passed           Boolean?
  startedAt        DateTime  @default(now())
  submittedAt      DateTime?
  timeSpentSeconds Int?
  status           String    @default("in_progress")
  attemptNumber    Int       @default(1)
  notes            String?
  createdAt        DateTime  @default(now())
  updatedAt        DateTime  @updatedAt
  survey           Survey    @relation(fields: [surveyId], references: [id], onDelete: Cascade)
  user             User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([surveyId, userId, attemptNumber])
  @@index([surveyId])
  @@index([userId])
  @@index([status])
  @@index([submittedAt])
}

model SurveyAnalytics {
  id                   String   @id @default(uuid())
  surveyId             String   @unique
  totalSubmissions     Int      @default(0)
  completedSubmissions Int      @default(0)
  averageScore         Float?
  averageTimeSpent     Float?
  passRate             Float?
  questionAnalytics    Json?
  lastCalculatedAt     DateTime @default(now())
  updatedAt            DateTime @updatedAt
  survey               Survey   @relation(fields: [surveyId], references: [id], onDelete: Cascade)

  @@index([surveyId])
}

enum UserRole {
  ADMIN
  COUNTRY_DIRECTOR
  DEPARTMENT_HEAD
  MANAGER
  STAFF
}

enum Department {
  HR
  FINANCE
  PROCUREMENT
  PROGRAMS
  MEAL
  IT
  OPERATIONS
  P_AND_D
  SSD
  COMMS
  PRM
  PR
  MHPSS
  BOD
  SMT
  EDU
  RRP
}

enum TrainingStatus {
  NOT_STARTED
  IN_PROGRESS
  COMPLETED
  EXPIRED
  OVERDUE
}

enum CourseType {
  MICRO_COURSE
  MANDATORY_COURSE
  PROFESSIONAL_COURSE
  DIPLOMA_TRACK
  LEADERSHIP_TRACK
}

enum CourseDuration {
  SHORT_TERM
  LONG_TERM
}

enum PolicyStatus {
  NOT_ACKNOWLEDGED
  ACKNOWLEDGED
  EXPIRED
  OVERDUE
}

enum MarketStatus {
  NEW
  UNDER_REVIEW
  APPROVED
  REJECTED
}

enum AccessLevel {
  GLOBAL
  COUNTRY
  DEPARTMENT
  ROLE
}
